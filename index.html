<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admission Prediction</title>

  <!-- ✅ Load ONNX Runtime Web first -->
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.17.1/dist/ort.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 40px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    form {
      background: #fff;
      padding: 25px;
      max-width: 500px;
      margin: 20px auto;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      font-weight: bold;
    }
    input {
      display: block;
      width: 100%;
      margin: 8px 0 16px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    #output {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      margin-top: 20px;
    }
  </style>
</head>

<body>
  <h1>Graduate Admission Predictor</h1>

  <form id="predictForm">
    <label for="gre">GRE Score</label>
    <input id="gre" type="number" step="0.1" required />

    <label for="toefl">TOEFL Score</label>
    <input id="toefl" type="number" step="0.1" required />

    <label for="rating">University Rating (1–5)</label>
    <input id="rating" type="number" step="1" min="1" max="5" required />

    <label for="sop">SOP</label>
    <input id="sop" type="number" step="0.1" required />

    <label for="lor">LOR</label>
    <input id="lor" type="number" step="0.1" required />

    <label for="cgpa">CGPA</label>
    <input id="cgpa" type="number" step="0.01" required />

    <label for="research">Research (0 = No, 1 = Yes)</label>
    <input id="research" type="number" step="1" min="0" max="1" required />

    <label for="extra_feature">Chance of Admit:</label>
    <input type="number" id="extra_feature" step="0.01" value="1"><br><br>

    <button type="submit">Predict</button>
  </form>

  <div id="output"></div>

  <script>
    // Load ONNX model when the page is ready
    window.addEventListener("load", async () => {
      // Confirm ONNX runtime loaded
      if (typeof ort === "undefined") {
        alert("❌ ONNX Runtime Web failed to load. Check your script tag.");
        return;
      }

      console.log("✅ ONNX Runtime Web available:", ort);

      // Try to load model
      let session;
      try {
        session = await ort.InferenceSession.create("best_model.onnx");
        console.log("✅ Model loaded successfully.");
      } catch (err) {
        console.error("❌ Failed to load ONNX model:", err);
        document.getElementById("output").textContent =
          "Error: Unable to load model. Ensure best_model.onnx is in the same directory.";
        return;
      }

      // Handle form submission
      document.getElementById("predictForm").addEventListener("submit", async (e) => {
        e.preventDefault();

        const gre = parseFloat(document.getElementById("gre").value);
        const toefl = parseFloat(document.getElementById("toefl").value);
        const rating = parseFloat(document.getElementById("rating").value);
        const sop = parseFloat(document.getElementById("sop").value);
        const lor = parseFloat(document.getElementById("lor").value);
        const cgpa = parseFloat(document.getElementById("cgpa").value);
        const research = parseFloat(document.getElementById("research").value);
        const extra_feature = parseFloat(document.getElementById('extra_feature').value)

        // Model input array (match training order)
        const inputData = [gre, toefl, rating, sop, lor, cgpa, research];

        try {
          // Convert to ONNX Tensor
          const tensor = new ort.Tensor("float32", Float32Array.from(inputData), [1, inputData.length]);

          // Feed it to model
          const feeds = { input: tensor };
          const results = await session.run(feeds);
          const output = results[Object.keys(results)[0]];

          // Show prediction
          const prediction = output.data[0];
          document.getElementById("output").textContent =
            `Predicted Chance of Admission: ${(prediction * 100).toFixed(2)}%`;
        } catch (err) {
          console.error("Prediction error:", err);
          document.getElementById("output").textContent =
            "❌ Error during prediction. Check the browser console for details.";
        }
      });
    });
  </script>
</body>
</html>

